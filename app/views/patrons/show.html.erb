<p><%= notice %></p>

<div class="container">
  <div class="row row-content">
    <div class="col col-6">
      <h4>Welcome, <i><%= @patron.name %></i>!
        <br>
        <br>
        <br>
        Library card number:<b> <%= @patron.library_card_number %></b></h4>
        <br>
        <br>
        <div class="card card-body bg-light">
          <blockquote class="blockquote">
            <p class="mb-3">“Books are a uniquely portable magic.”</p>
            <footer class="blockquote-footer">Stephen King</footer>
          </blockquote>
        </div>
    </div>
    <div class="col-5 offset-1">
      <img src="https://upload.wikimedia.org/wikipedia/commons/c/c0/Books_on_a_shelf_perspective.jpg" alt="Books on a shelf"style="width:300px;height:300px;">
      <footer class="image-footer"><cite>citation: Jess Mann</cite></footer>
    </div>
</div>


<br>
<h4>My Checkouts:<br></h4>

<div class="table-responsive">
<table class="table table-striped table-hover">
  <thead class="thead-dark">
    <tr>
      <th>Title</th>
      <th>Author</th>
      <th>Genre</th>
      <th>Library</th>
      <th>Return Book</th>
      <th>Book Details</th>
      <th>Due Date</th>
    </tr>
  </thead>
  <tbody>
    <% @book_loans.each do |loan| %>
      <tr>
        <td><%= link_to loan.book.title, library_book_path(loan.book.library_id) %></td>
        <td><%= loan.book.author.author_name %></td>
        <td><%= loan.book.genre.name %></td>
        <td><%= loan.book.library.name %></td>
        <td>
          <%= form_with url: book_loan_path(loan.id), method: :patch, local: true do |f| %>
            <%= f.submit "Return this book" %>
          <% end %>
        </td>
        <td>
          <form action="/libraries/<%= loan.book.library_id %>/books/<%= loan.book.id %>" class="js-book-details" id="<%= loan.book.id %>" data-id="<%= loan.book.id %>">
            <button type="submit">Book Description</button>
          </form>
        </td>
        <td>
          <% due_date = (loan.created_at + 21.day).strftime("%m/%d/%Y")  %>
          <% if (loan.created_at + 21.day) < Time.current %>
            <h5>OVERDUE</h5>
          <% else %>
            <%= due_date %>
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
</div>
<br>

<div class="container">
  <div class="row row-content">
    <h5>To check out another book, first choose the library closest to you:</h5>
  </div>
</div>
<br>
<div class="container">
  <div class="row row-content">
    <div class="col-12 col-sm-6">
      <h5>
        <b><u>Northeastern Narnia </u></b><br>
        <% @ne_library_regions.each do |library| %>
          <br><%= link_to library.name, library_path(library) %><br>
        <% end %>
      </h5>
    </div>

    <div class="col-12 col-sm-6">
      <h5>
        <b><u>Southeastern Narnia </u> </b><br>
        <% @se_library_regions.each do |library| %>
          <br><%= link_to library.name, library_path(library) %><br>
        <% end %>
      </h5>
    </div>
  </div>
</div>

<br>

<div class="container">
  <div class="row row-content">
    <div class="col-12 col-sm-6 order-sm-first">
      <h5>
        <b><u>Northwestern Narnia</u></b><br>
        <% @nw_library_regions.each do |library| %>
          <br><%= link_to library.name, library_path(library) %><br>
        <% end %>
      </h5>
    </div>

    <div class="col-12 col-sm-6">
      <h5>
        <b><u> Southwestern Narnia </u></b><br>
        <% @sw_library_regions.each do |library| %>
          <br><%= link_to library.name, library_path(library) %><br>
        <% end %>
      </h5>
    </div>
  </div>
</div>

